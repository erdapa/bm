
1. remove cycles
2. find duplicate objects and keep those with shorter paths
3. flatten
